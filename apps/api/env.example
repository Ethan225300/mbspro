# ============================================
# MBSPro API - Environment Configuration
# ============================================

# Server Configuration
PORT=4000
NODE_ENV=development

# ============================================
# Supabase Configuration (REQUIRED)
# ============================================
# Get these values from your Supabase project dashboard:
# 1. Go to https://supabase.com/dashboard
# 2. Select your project
# 3. Go to Settings > API

# Project URL (required)
SUPABASE_URL=https://your-project-id.supabase.co

# Anonymous Key (required for client-side operations)
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...your-anon-key-here

# Service Role Key (required for server-side operations with full access)
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...your-service-role-key-here

# ============================================
# Database Configuration (REQUIRED)
# ============================================
# PostgreSQL connection string from Supabase
# Format: postgresql://postgres:password@db.project-id.supabase.co:5432/postgres
# Note: SSL is required for Supabase connections
DATABASE_URL=postgresql://postgres:your_password@db.your-project-id.supabase.co:5432/postgres?sslmode=require

# PostgreSQL SSL Mode (optional, defaults to 'require' for Supabase)
PGSSLMODE=require

# ============================================
# Application Configuration
# ============================================

# API Configuration
API_PREFIX=api
SWAGGER_ENABLED=true

# CORS Configuration
FRONTEND_URL=http://localhost:3000

# Suggest Pipeline Mode: local | rag | hybrid
SUGGEST_MODE=local

# ============================================
# Confidence Calculation Configuration
# ============================================

# Sigmoid parameters for confidence calculation (optimized values)
# K controls steepness (higher = steeper curve, better separation)
SUGGEST_SIGMOID_K=2.6
MBS_SIGMOID_K=2.6

# Center point for sigmoid (lower = easier to achieve high confidence)
SUGGEST_SIGMOID_CENTER=0.15
MBS_SIGMOID_CENTER=0.15

# Ranker weights for scoring
RANKER_ALPHA=0.7
RANKER_BETA=0.3

# RAG/Lexical/Feature fusion weights
SUGGEST_RAG_WEIGHT=0.7
SUGGEST_FEAT_WEIGHT=0.1
SUGGEST_LEX_WEIGHT=0.2

# Evidence and penalty weights
SUGGEST_PENALTY_WEIGHT=0.8
SUGGEST_WARN_DECAY=0.09
SUGGEST_WARN_MAX=0.35

# Margin and agreement boosts
SUGGEST_MARGIN_MAX=0.25
SUGGEST_AGREEMENT_BOOST=1.06
SUGGEST_GAMMA=1.35

# ============================================
# Development Configuration
# ============================================

# Enable detailed logging in development
LOG_LEVEL=debug

# ============================================
# RAG Configuration (Optional)
# ============================================

# Embedding Provider: 'mistral' or 'openai'
EMBED_PROVIDER=mistral

# Mistral AI (Recommended for embeddings)
MISTRAL_API_KEY=mistral-xxx
MISTRAL_EMBED_MODEL=mistral-embed

# OpenAI (Fallback option)
OPENAI_API_KEY=sk-xxx
OPENAI_CHAT_MODEL=gpt-4o-mini
OPENAI_EMBED_MODEL=text-embedding-3-small

# Pinecone Vector Database
PINECONE_API_KEY=pc-xxx
PINECONE_INDEX=mbspro-langchain-api

# Cohere (optional rerank)
COHERE_API_KEY=cohere-xxx
COHERE_RERANK_MODEL=rerank-english-v3.0

# Rerank candidate count and threshold (optional)
RERANK_CANDIDATES=60
RERANK_THRESHOLD=0.0

# Ingest security (optional)
INGEST_SECRET=dev-ingest-secret

# ============================================
# Instructions:
# 1. Copy this file to .env: cp env.example .env
# 2. Replace all placeholder values with your actual Supabase credentials
# 3. Never commit .env to version control
# ============================================
